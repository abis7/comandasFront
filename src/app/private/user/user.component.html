<div class="flex justify-center items-center p-4 sm:p-8 bg-gray-50 min-h-screen font-outfit">
    
    <div class="w-full max-w-4xl bg-white p-6 sm:p-10 rounded-3xl shadow-2xl border border-gray-100">
        
        <h2 class="text-3xl font-extrabold text-gray-900 mb-8 pb-4 border-b border-gray-100 flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M15 6v12M9 6v12M4 12h16M11 5c1.1 0 2 .9 2 2v10c0 1.1-.9 2-2 2s-2-.9-2-2V7c0-1.1.9-2 2-2zm10 5a2 2 0 1 0 0 4 2 2 0 0 0 0-4zM3 10a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/>
            </svg>
            {{ id ? 'Actualizar Perfil de Usuario' : 'Crear Nuevo Usuario' }}
        </h2>

        <form [formGroup]="formulario" (ngSubmit)="save()">
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 mb-8">
                
                <div class="md:col-span-1 space-y-6">
                    
                    <mat-form-field appearance="outline" class="w-full">
                        <mat-label>Nombre</mat-label>
                        <input type="text" matInput formControlName="name" placeholder="Nombre completo">
                        @if (formulario.controls['name'].hasError('required')) {
                            <mat-error>El nombre es requerido</mat-error>
                        }
                    </mat-form-field>
                    
                    <mat-form-field appearance="outline" class="w-full">
                        <mat-label>Email</mat-label>
                        <input type="email" matInput formControlName="email" placeholder="usuario@ejemplo.com">
                        @if (formulario.controls['email'].hasError('required')) {
                            <mat-error>El email es requerido</mat-error>
                        }
                        @if (formulario.controls['email'].hasError('email')) {
                            <mat-error>Email con formato inválido</mat-error>
                        }
                    </mat-form-field>

                    <mat-form-field appearance="outline" class="w-full">
                        <mat-label>Telefono</mat-label>
                        <input type="text" matInput formControlName="phone" placeholder="Ej: 55 1234 5678">
                    </mat-form-field>

                </div>

                <div class="md:col-span-1 space-y-6">
                    
                    <mat-form-field appearance="outline" class="w-full">
                        <mat-label>Contraseña</mat-label>
                        <input type="password" matInput formControlName="password" placeholder="{{ id ? 'Dejar vacío para no cambiar' : 'Requerida para creación' }}">
                        @if (formulario.controls['password'].hasError('required')) {
                            <mat-error>La contraseña es requerida</mat-error>
                        }
                    </mat-form-field>
                    
                    <mat-form-field appearance="outline" class="w-full">
                        <mat-label>Rol</mat-label>
                        <mat-select formControlName="rol">
                            @for (rol of roles; track $index) {
                                <mat-option [value]="rol.value">{{rol.name}}</mat-option>
                            }
                        </mat-select>
                        @if (formulario.controls['rol'].hasError('required')) {
                            <mat-error>El rol es requerido</mat-error>
                        }
                    </mat-form-field>
                    
                    <div class="h-12 md:h-20"></div> 
                </div>

            </div>

            <div class="flex gap-4 pt-6 border-t border-gray-200 justify-end">
                
                @if (id) {
                    <button type="button" 
                            class="button-secundary font-bold py-3 px-8 rounded-xl transition-all duration-300 hover:shadow-lg" 
                            (click)="deleteUser()">
                        Eliminar Usuario
                    </button>
                }

                <button type="submit" 
                        [disabled]="formulario.invalid"
                        class="button-primary font-bold py-3 px-10 rounded-xl transition-all duration-300 shadow-md hover:shadow-lg disabled:opacity-60 disabled:cursor-not-allowed">
                    Guardar Cambios
                </button>
            </div>
        </form>
    </div>
</div>